/*!
 * Cartonbox v1.5.4 by Maxim Sofronov <imaxsof@gmail.com>
 * Correct modal windows
 * Demo: https://constlab.github.io/cartonbox/
 * License: MIT
 */

!function(t){"use strict";var a={init:function(a){function o(t,a,o){x.historyPush?window.history.pushState(t,a,o):window.history.replaceState(t,a,o)}function n(a){if(a.attr("data-cb-group")&&""!=a.attr("data-cb-group")&&"dotted"==x.nav){var o=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"]").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").length;if(o>1){for(var n="",r=0;r<o;r++){var c=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+r+"]"),e=c.attr("href"),b=c.attr("data-cb-type"),d=c.attr("data-cb-caption"),i=c.attr("data-cb-hash"),s=c.attr("data-cb-design"),p=c.attr("data-cb-fragment"),l=c.attr("data-cb-options");n=n+'<li><a href="'+e+'" class="cartonbox" data-cb-type="'+b+'" data-cb-group="'+a.attr("data-cb-group")+'" data-cb-group-index="'+r+'"'+(d&&""!=d?' data-cb-caption="'+d+'"':"")+(i&&""!=i?' data-cb-hash="'+i+'"':"")+(s&&""!=s?' data-cb-design="'+s+'"':"")+(l&&""!=l?' data-cb-options="'+l+'"':"")+(p&&""!=p?' data-cb-fragment="'+p+'"':"")+"></a></li>"}t(".cartonbox-nav").html('<ul class="cartonbox-nav-dotted">'+n+"</ul>"),t(".cartonbox-nav").show()}}}function r(a){if(void 0==t(".cartonbox-body").data("cb-top")){if(x.onStartBefore(a),void 0==t(".cartonbox-body").data("cb-existing-hash")&&(s=window.location.hash,s=s.replace("#",""),t(".cartonbox-body").data("cb-existing-hash",s)),void 0==t(".cartonbox-body").data("cb-top")){var o=t(window).scrollTop();t(".cartonbox-body").data("cb-top",o).css({position:"fixed",top:-o,left:0,right:0,bottom:0,overflow:"hidden"})}t(".cartonbox-back").fadeIn(x.speed),n(a),x.onStartAfter(a)}c(a)}function c(a){d(a);var r=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"]").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").length,c=t(".cartonbox-nav li").length;if(r>c&&n(a),t(".cartonbox-nav-dotted").length&&t(".cartonbox-nav-dotted li").removeClass("active").eq(a.attr("data-cb-group-index")).addClass("active"),t(".cartonbox-mark").length){var i=t(".cartonbox-mark").attr("data-cb-mark");t(".cartonbox-content").find(i).prependTo(".cartonbox-mark"),t(".cartonbox-mark").children().unwrap()}t(".cartonbox-content").hide().html(""),t(".cartonbox-wrap").removeAttr("class data-cb-options").addClass("cartonbox-wrap");var s=a.attr("data-cb-options");s&&""!=s&&t(".cartonbox-wrap").attr("data-cb-options",s),x.onLoadBefore(a),t(".cartonbox-preloader").show();var p=a.attr("href"),l=a.attr("data-cb-type"),h=a.attr("data-cb-hash");h&&""!=h?o(null,null,"#"+h):o(null,null," ");var g=a.attr("data-cb-design");g&&""!=g&&t(".cartonbox-wrap").addClass(g);var v=a.attr("data-cb-fragment");"inline"==l?t(p).length?(t(p).wrap('<div class="cartonbox-mark" data-cb-mark="'+p+'"></div>'),t(p).prependTo(".cartonbox-content"),t(".cartonbox-wrap").addClass("cartonbox-inline"),x.preload?e(a):b(a)):(b(a),t.error("Unable to load data!")):"iframe"==l?/ /.test(p)||v&&""!=v?(v&&(p=p+" "+v),t(".cartonbox-content").load(p,function(){x.preload?e(a):b(a)}),t(".cartonbox-wrap").addClass("cartonbox-inline")):(t(".cartonbox-content").html('<iframe src="'+p+'" frameborder="0"></iframe>'),e(a),t(".cartonbox-wrap").addClass("cartonbox-iframe")):"img"==l&&(t(".cartonbox-content").html('<img src="'+p+'">'),t(".cartonbox-wrap").addClass("cartonbox-img"),e(a))}function e(a){var o=new Array,n=new Array;t(".cartonbox-container, .cartonbox-container *").each(function(){if("none"!=t(this).css("background-image")){var a=t(this).css("background-image");/url\(/i.test(a)&&(a=a.replace(/^(url\()?\"?\'?/i,""),a=a.replace(/\"?\'?\)?$/i,""),o.push(a))}t(this).is("img[src]")&&o.push(t(this).attr("src")),t(this).is("iframe")&&n.push(t(this))});var r=o.length+n.length;if(r>0){var c=0;if(o.length>0)for(var e=0;e<o.length;e++){var d=new Image;t(d).attr("src",(/^https:/.test(o[e])?"https:":/^http:/.test(o[e])?"http:":"")+o[e].replace(/^http(s)?:/i,"")).on("error",function(){c++,r==c&&b(a),t.error("Unable to load data!")}).load(function(){c++,r==c&&b(a,d.naturalWidth,d.naturalHeight)})}if(n.length>0)for(var e=0;e<n.length;e++)t(n[e]).load(function(){c++,r==c&&b(a)})}else b(a)}function b(a,o,n){if(x.onLoadAfter(a),x.onShowBefore(a),t(".cartonbox-preloader").hide(),t(".cartonbox-wrap").hasClass("cartonbox-img")){var r=1*t(".cartonbox-flex").css("padding-top").replace(/px/i,"")+1*t(".cartonbox-flex").css("padding-bottom").replace(/px/i,""),c=1*t(".cartonbox-wrap").css("padding-left").replace(/px/i,"")+1*t(".cartonbox-wrap").css("padding-right").replace(/px/i,"");a.attr("data-cb-group")&&""!=a.attr("data-cb-group")&&"dotted"==x.nav&&(r+=t(".cartonbox-nav").innerHeight());var e=n/o;o+c>=t(window).width()?(o=t(window).width()-c,n=o*e,n>t(window).height()-r&&(o=(t(window).height()-r)/e,n=o*e)):n+r>=t(window).height()&&(n=t(window).height()-r,o=n/e,o>t(window).width()-c&&(o=t(window).width()-c)),t(".cartonbox-content img").attr({width:Math.ceil(o),height:Math.ceil(n)}),t(".cartonbox-wrap").css("width",o+c)}else t(".cartonbox-wrap").css("width","");var b=a.attr("data-cb-caption");if(b&&""!=b){var d=/^#[\w-]+$/.test(b);d&&t(b).length?(t('<div class="cartonbox-caption"><div class="cartonbox-caption-text"></div></div>').appendTo(".cartonbox-content"),t(b).wrap('<div class="cartonbox-mark" data-cb-mark="'+b+'"></div>'),t(b).prependTo(".cartonbox-caption-text")):t('<div class="cartonbox-caption"><div class="cartonbox-caption-text">'+b+"</div></div>").appendTo(".cartonbox-content")}t(".cartonbox-content").show(),t(".cartonbox-container").width("").height(""),t(".cartonbox-wrap:visible").length?(x.onShowNow(a),x.onShowAfter(a)):(t(".cartonbox-wrap").fadeIn(x.speed,function(){x.onShowAfter(a)}),t(".cartonbox-close").fadeIn(x.speed),t(".cartonbox-prev a").length&&t(".cartonbox-prev").fadeIn(x.speed),t(".cartonbox-next a").length&&t(".cartonbox-next").fadeIn(x.speed),x.onShowNow(a)),t(".cartonbox-container").width(t(".cartonbox-container").width()).height(t(".cartonbox-container").height()),t(window).scrollTop(0)}function d(a){if(a.attr("data-cb-group")){var o=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"]").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").length;if((0!=a.attr("data-cb-group-index")||x.cycle)&&o>1){var n=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+(1*a.attr("data-cb-group-index")-1)+"]"),r=1*a.attr("data-cb-group-index")-1;0==a.attr("data-cb-group-index")&&(n=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+(o-1)+"]"),r=o-1);var c=n.attr("href"),e=n.attr("data-cb-type"),b=n.attr("data-cb-caption"),d=n.attr("data-cb-hash"),i=n.attr("data-cb-design"),s=n.attr("data-cb-fragment"),p=n.attr("data-cb-options");t(".cartonbox-prev").html('<a href="'+c+'" class="cartonbox" data-cb-type="'+e+'" data-cb-group="'+a.attr("data-cb-group")+'" data-cb-group-index="'+r+'"'+(b&&""!=b?' data-cb-caption="'+b+'"':"")+(d&&""!=d?' data-cb-hash="'+d+'"':"")+(i&&""!=i?' data-cb-design="'+i+'"':"")+(p&&""!=p?' data-cb-options="'+p+'"':"")+(s&&""!=s?' data-cb-fragment="'+s+'"':"")+">"+x.prevHtml+"</a>"),t(".cartonbox-wrap:visible").length&&t(".cartonbox-prev").show()}else t(".cartonbox-prev").html("").hide();if((a.attr("data-cb-group-index")!=o-1||x.cycle)&&o>1){var l=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+(1*a.attr("data-cb-group-index")+1)+"]"),h=1*a.attr("data-cb-group-index")+1;a.attr("data-cb-group-index")==o-1&&(l=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index=0]"),h=0);var g=l.attr("href"),v=l.attr("data-cb-type"),u=l.attr("data-cb-caption"),w=l.attr("data-cb-hash"),f=l.attr("data-cb-design"),m=l.attr("data-cb-fragment"),y=l.attr("data-cb-options");t(".cartonbox-next").html('<a href="'+g+'" class="cartonbox" data-cb-type="'+v+'" data-cb-group="'+a.attr("data-cb-group")+'" data-cb-group-index="'+h+'"'+(u&&""!=u?' data-cb-caption="'+u+'"':"")+(w&&""!=w?' data-cb-hash="'+w+'"':"")+(f&&""!=f?' data-cb-design="'+f+'"':"")+(y&&""!=y?' data-cb-options="'+y+'"':"")+(m&&""!=m?' data-cb-fragment="'+m+'"':"")+">"+x.nextHtml+"</a>"),t(".cartonbox-wrap:visible").length&&t(".cartonbox-next").show()}else t(".cartonbox-next").html("").hide()}}function i(){if(x.onClosedBefore(),t(".cartonbox-back, .cartonbox-close, .cartonbox-prev, .cartonbox-next").fadeOut(x.speed),t(".cartonbox-preloader").hide(),""!=window.location.hash&&o(null,null," "),""!=t(".cartonbox-body").data("cb-existing-hash")){var a=t(".cartonbox-body").data("cb-existing-hash");t(".cartonbox[data-cb-hash="+a+"]").length||o(null,null,"#"+t(".cartonbox-body").data("cb-existing-hash"))}t(".cartonbox-wrap").fadeOut(x.speed,function(){if(t(".cartonbox-nav").hide(),t(".cartonbox-mark").length){var a=t(".cartonbox-mark").attr("data-cb-mark");t(".cartonbox-content").find(a).prependTo(".cartonbox-mark"),t(".cartonbox-mark").children().unwrap()}t(".cartonbox-wrap").removeAttr("class data-cb-options").addClass("cartonbox-wrap"),t(".cartonbox-content, .cartonbox-prev, .cartonbox-next, .cartonbox-nav").html(""),t(".cartonbox-wrap, .cartonbox-container").removeAttr("style");var o=1*t(".cartonbox-body").data("cb-top");t(".cartonbox-body").removeData("cb-top cb-existing-hash").removeAttr("style"),t(window).scrollTop(o),x.onClosedAfter()})}var x=t.extend({wrap:"body",speed:200,nav:"dotted",cycle:!1,preload:!0,historyPush:!1,closeHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25"><polygon points="24.4,1.4 23.6,0.6 12.5,11.8 1.4,0.6 0.6,1.4 11.8,12.5 0.6,23.6 1.4,24.4 12.5,13.2 23.6,24.4 24.4,23.6 13.2,12.5"></polygon></svg>',prevHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 55"><polygon points="23.7,54.3 24.6,53.7 1.5,26.5 24.6,1.3 23.7,0.7 0.3,26.5"></polygon></svg>',nextHtml:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 55"><polygon points="1.4,54.3 0.6,53.7 23.1,26.5 0.6,1.3 1.4,0.7 24.3,26.5"></polygon></svg>',onStartBefore:function(){},onStartAfter:function(){},onLoadBefore:function(){},onLoadAfter:function(){},onShowBefore:function(){},onShowNow:function(){},onShowAfter:function(){},onClosedBefore:function(){},onClosedAfter:function(){},onLeft:function(){},onRight:function(){}},a);t(".cartonbox-body").length||t(x.wrap).wrapInner('<div class="cartonbox-body"></div>'),t(".cartonbox-back").length||t('<div class="cartonbox-back"></div>').insertAfter(".cartonbox-body"),t(".cartonbox-preloader").length||t('<div class="cartonbox-preloader"></div>').insertAfter(".cartonbox-back"),t(".cartonbox-wrap").length||t('<div class="cartonbox-wrap"><div class="cartonbox-flex"><div class="cartonbox-item"><div class="cartonbox-container"><div class="cartonbox-content"></div></div></div><div class="cartonbox-nav"></div></div></div><div class="cartonbox-close">'+x.closeHtml+'</div><div class="cartonbox-prev"></div><div class="cartonbox-next"></div>').insertAfter(".cartonbox-preloader"),t(".cartonbox").each(function(){t(this).attr("data-cb-group")&&!t(this).attr("data-cb-group-index")&&t(".cartonbox[data-cb-group="+t(this).attr("data-cb-group")+"]").each(function(a){t(this).attr("data-cb-group-index",a)})});var s=window.location.hash;""!=s&&"#"!=s&&(s=s.replace("#",""),t(".cartonbox[data-cb-hash="+s+"]").length&&r(t(".cartonbox[data-cb-hash="+s+"]"))),t("body, .cartonbox-back, .cartonbox-preloader, .cartonbox-wrap, .cartonbox-flex, .cartonbox-item, .cartonbox-close, .cartonbox-close svg, .cartonbox-close polygon, .cartonbox-nav").unbind(".onClick"),t(window).unbind(".onClick"),t("body").on("click.onClick",".cartonbox-body .cartonbox, .cartonbox-content .cartonbox",function(){return r(t(this)),!1}),t("body").on("click.onClick",".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav li:not(.active) a",function(){return t(this).parent().hasClass("cartonbox-prev")&&x.onLeft(t(this)),t(this).parent().hasClass("cartonbox-next")&&x.onRight(t(this)),c(t(this)),!1}),t(".cartonbox-wrap").on("click.onClick",".cartonbox-nav .active a",function(){return!1}),t(window).on("keydown.onClick",function(a){void 0==t(".cartonbox-body").data("cb-top")||t(":input:focus").length||(37==a.which?t(".cartonbox-prev a").length&&(x.onLeft(t(".cartonbox-prev a")),c(t(".cartonbox-prev a"))):39==a.which&&t(".cartonbox-next a").length&&(x.onRight(t(".cartonbox-next a")),c(t(".cartonbox-next a"))))}),t(".cartonbox-back, .cartonbox-preloader, .cartonbox-wrap, .cartonbox-flex, .cartonbox-item, .cartonbox-close, .cartonbox-close svg, .cartonbox-close use, .cartonbox-close polygon, .cartonbox-nav").on("click.onClick",function(t){t.target==this&&i()}),t(window).on("keydown.onClick",function(a){void 0!=t(".cartonbox-body").data("cb-top")&&27==a.which&&i()})},refresh:function(){t(".cartonbox").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").removeAttr("data-cb-group-index"),t(".cartonbox").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").each(function(){t(this).attr("data-cb-group")&&!t(this).attr("data-cb-group-index")&&t(".cartonbox[data-cb-group="+t(this).attr("data-cb-group")+"]").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").each(function(a){t(this).attr("data-cb-group-index",a)})})},destroy:function(){t(".cartonbox").removeAttr("data-cb-group-index"),t("body").unbind(".onClick"),t(window).unbind(".onClick"),t(".cartonbox-body").children().unwrap(),t(".cartonbox-back, .cartonbox-preloader, .cartonbox-wrap, .cartonbox-close, .cartonbox-prev, .cartonbox-next").remove()}};t.cartonbox=function(o){return a[o]?a[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" not found!"):a.init.apply(this,arguments)}}(jQuery);