/*
 * CartonBox 1.5.1 by Const Lab, cartonbox.constlab.com
 */
!function(t){"use strict";var a={init:function(a){function o(a){if(!t(".cartonbox-body").data("cb-top")){if(i.onStartBefore(a),t(".cartonbox-body").data("cb-existing-hash")||(d=window.location.hash,d=d.replace("#",""),t(".cartonbox-body").data("cb-existing-hash",d)),!t(".cartonbox-body").data("cb-top")){var o=t(window).scrollTop();t(".cartonbox-body").data("cb-top",o).css({position:"fixed",top:-o,left:0,right:0,bottom:0,overflow:"hidden"})}if(t(".cartonbox-back").fadeIn(i.speed),a.attr("data-cb-group")&&""!=a.attr("data-cb-group")&&"dotted"==i.nav){var r=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"]").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").length;if(r>1){for(var c="",e=0;r>e;e++){var b=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+e+"]"),x=b.attr("href"),s=b.attr("data-cb-type"),p=b.attr("data-cb-caption"),l=b.attr("data-cb-hash"),h=b.attr("data-cb-design"),g=b.attr("data-cb-fragment"),u=b.attr("data-cb-options");c=c+'<li><a href="'+x+'" class="cartonbox" data-cb-type="'+s+'" data-cb-group="'+a.attr("data-cb-group")+'" data-cb-group-index="'+e+'"'+(p&&""!=p?' data-cb-caption="'+p+'"':"")+(l&&""!=l?' data-cb-hash="'+l+'"':"")+(h&&""!=h?' data-cb-design="'+h+'"':"")+(u&&""!=u?' data-cb-options="'+u+'"':"")+(g&&""!=g?' data-cb-fragment="'+g+'"':"")+"></a></li>"}t(".cartonbox-nav").html('<ul class="cartonbox-nav-dotted">'+c+"</ul>"),t(".cartonbox-nav").show()}}i.onStartAfter(a)}n(a)}function n(a){e(a),t(".cartonbox-nav-dotted").length&&t(".cartonbox-nav-dotted li").removeClass("active").eq(a.attr("data-cb-group-index")).addClass("active"),t(".cartonbox-content").hide().html(""),t(".cartonbox-wrap").removeAttr("class data-cb-options").addClass("cartonbox-wrap");var o=a.attr("data-cb-options");o&&""!=o&&t(".cartonbox-wrap").attr("data-cb-options",o),i.onLoadBefore(a),t(".cartonbox-preloader").show();var n=a.attr("href"),b=a.attr("data-cb-type"),d=a.attr("data-cb-hash");d&&""!=d?window.history.replaceState(null,null,"#"+d):window.history.replaceState(null,null," ");var x=a.attr("data-cb-design");x&&""!=x&&t(".cartonbox-wrap").addClass(x);var s=a.attr("data-cb-fragment");"inline"==b?t(n).length?(t(n).clone(!0).prependTo(".cartonbox-content"),t(".cartonbox-wrap").addClass("cartonbox-inline"),r(a)):(c(a),t.error("Unable to load data!")):"iframe"==b?/ /.test(n)||s&&""!=s?(s&&(n=n+" "+s),t(".cartonbox-content").load(n,function(){r(a)}),t(".cartonbox-wrap").addClass("cartonbox-inline")):(t(".cartonbox-content").html('<iframe src="'+n+'" frameborder="0"></iframe>'),r(a),t(".cartonbox-wrap").addClass("cartonbox-iframe")):"img"==b&&(t(".cartonbox-content").html('<img src="'+n+'">'),t(".cartonbox-wrap").addClass("cartonbox-img"),r(a))}function r(a){var o=new Array,n=new Array;t(".cartonbox-container, .cartonbox-container *").each(function(){if("none"!=t(this).css("background-image")){var a=t(this).css("background-image");/url\(/i.test(a)&&(a=a.replace(/^(url\()?\"?\'?/i,""),a=a.replace(/\"?\'?\)?$/i,""),o.push(a))}t(this).is("img[src]")&&o.push(t(this).attr("src")),t(this).is("iframe")&&n.push(t(this))});var r=o.length+n.length;if(r>0){var e=0;if(o.length>0)for(var b=0;b<o.length;b++){var i=new Image;t(i).attr("src",(/^https:/.test(o[b])?"https:":"http:")+o[b]).on("error",function(){e++,r==e&&c(a),t.error("Unable to load data!")}).load(function(){e++,r==e&&c(a,i.naturalWidth,i.naturalHeight)})}if(n.length>0)for(var b=0;b<n.length;b++)t(n[b]).load(function(){e++,r==e&&c(a)})}else c(a)}function c(a,o,n){if(i.onLoadAfter(a),i.onShowBefore(a),t(".cartonbox-preloader").hide(),t(".cartonbox-wrap").hasClass("cartonbox-img")){var r=1*t(".cartonbox-flex").css("padding-top").replace(/px/i,"")+1*t(".cartonbox-flex").css("padding-bottom").replace(/px/i,""),c=1*t(".cartonbox-wrap").css("padding-left").replace(/px/i,"")+1*t(".cartonbox-wrap").css("padding-right").replace(/px/i,"");a.attr("data-cb-group")&&""!=a.attr("data-cb-group")&&"dotted"==i.nav&&(r+=t(".cartonbox-nav").innerHeight());var e=n/o;o+c>=t(window).width()?(o=t(window).width()-c,n=o*e,n>t(window).height()-r&&(o=(t(window).height()-r)/e,n=o*e)):n+r>=t(window).height()&&(n=t(window).height()-r,o=n/e,o>t(window).width()-c&&(o=t(window).width()-c)),t(".cartonbox-content img").attr({width:Math.ceil(o),height:Math.ceil(n)}),t(".cartonbox-wrap").css("width",o+c)}else t(".cartonbox-wrap").css("width","");var b=a.attr("data-cb-caption");if(b&&""!=b){var d=/^#[\w-]+$/.test(b);d&&t(b).length?(t('<div class="cartonbox-caption"><div class="cartonbox-caption-text"></div></div>').appendTo(".cartonbox-content"),t(b).clone(!0).prependTo(".cartonbox-caption-text")):t('<div class="cartonbox-caption"><div class="cartonbox-caption-text">'+b+"</div></div>").appendTo(".cartonbox-content")}t(".cartonbox-content").show(),t(".cartonbox-container").width("").height(""),t(".cartonbox-wrap:visible").length?(i.onShowNow(a),i.onShowAfter(a)):(t(".cartonbox-wrap").fadeIn(i.speed,function(){i.onShowAfter(a)}),t(".cartonbox-close").fadeIn(i.speed),t(".cartonbox-prev a").length&&t(".cartonbox-prev").fadeIn(i.speed),t(".cartonbox-next a").length&&t(".cartonbox-next").fadeIn(i.speed),i.onShowNow(a)),t(".cartonbox-container").width(t(".cartonbox-container").width()).height(t(".cartonbox-container").height()),t(window).scrollTop(0)}function e(a){if(a.attr("data-cb-group")){var o=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"]").not(".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav a").length;if((0!=a.attr("data-cb-group-index")||i.cycle)&&o>1){var n=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+(1*a.attr("data-cb-group-index")-1)+"]"),r=1*a.attr("data-cb-group-index")-1;0==a.attr("data-cb-group-index")&&(n=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+(o-1)+"]"),r=o-1);var c=n.attr("href"),e=n.attr("data-cb-type"),b=n.attr("data-cb-caption"),d=n.attr("data-cb-hash"),x=n.attr("data-cb-design"),s=n.attr("data-cb-fragment"),p=n.attr("data-cb-options");t(".cartonbox-prev").html('<a href="'+c+'" class="cartonbox" data-cb-type="'+e+'" data-cb-group="'+a.attr("data-cb-group")+'" data-cb-group-index="'+r+'"'+(b&&""!=b?' data-cb-caption="'+b+'"':"")+(d&&""!=d?' data-cb-hash="'+d+'"':"")+(x&&""!=x?' data-cb-design="'+x+'"':"")+(p&&""!=p?' data-cb-options="'+p+'"':"")+(s&&""!=s?' data-cb-fragment="'+s+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 55"><polygon points="23.7,54.3 24.6,53.7 1.5,26.5 24.6,1.3 23.7,0.7 0.3,26.5"></polygon></svg></a>'),t(".cartonbox-wrap:visible").length&&t(".cartonbox-prev").show()}else t(".cartonbox-prev").html("").hide();if((a.attr("data-cb-group-index")!=o-1||i.cycle)&&o>1){var l=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index="+(1*a.attr("data-cb-group-index")+1)+"]"),h=1*a.attr("data-cb-group-index")+1;a.attr("data-cb-group-index")==o-1&&(l=t(".cartonbox[data-cb-group="+a.attr("data-cb-group")+"][data-cb-group-index=0]"),h=0);var g=l.attr("href"),u=l.attr("data-cb-type"),v=l.attr("data-cb-caption"),w=l.attr("data-cb-hash"),f=l.attr("data-cb-design"),y=l.attr("data-cb-fragment"),m=l.attr("data-cb-options");t(".cartonbox-next").html('<a href="'+g+'" class="cartonbox" data-cb-type="'+u+'" data-cb-group="'+a.attr("data-cb-group")+'" data-cb-group-index="'+h+'"'+(v&&""!=v?' data-cb-caption="'+v+'"':"")+(w&&""!=w?' data-cb-hash="'+w+'"':"")+(f&&""!=f?' data-cb-design="'+f+'"':"")+(m&&""!=m?' data-cb-options="'+m+'"':"")+(y&&""!=y?' data-cb-fragment="'+y+'"':"")+'><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 55"><polygon points="1.4,54.3 0.6,53.7 23.1,26.5 0.6,1.3 1.4,0.7 24.3,26.5"></polygon></svg></a>'),t(".cartonbox-wrap:visible").length&&t(".cartonbox-next").show()}else t(".cartonbox-next").html("").hide()}}function b(){if(i.onClosedBefore(),t(".cartonbox-back, .cartonbox-close, .cartonbox-prev, .cartonbox-next").fadeOut(i.speed),t(".cartonbox-preloader").hide(),""!=window.location.hash&&window.history.replaceState(null,null," "),""!=t(".cartonbox-body").data("cb-existing-hash")){var a=t(".cartonbox-body").data("cb-existing-hash");t(".cartonbox[data-cb-hash="+a+"]").length||window.history.replaceState(null,null,"#"+t(".cartonbox-body").data("cb-existing-hash"))}t(".cartonbox-wrap").fadeOut(i.speed,function(){t(".cartonbox-nav").hide(),t(".cartonbox-wrap").removeAttr("class data-cb-options").addClass("cartonbox-wrap"),t(".cartonbox-content, .cartonbox-prev, .cartonbox-next, .cartonbox-nav").html(""),t(".cartonbox-wrap, .cartonbox-container").removeAttr("style");var a=1*t(".cartonbox-body").data("cb-top");t(".cartonbox-body").removeData("cb-top cb-existing-hash").removeAttr("style"),t(window).scrollTop(a),i.onClosedAfter()})}var i=t.extend({wrap:"body",speed:200,nav:"dotted",cycle:!1,onStartBefore:function(){},onStartAfter:function(){},onLoadBefore:function(){},onLoadAfter:function(){},onShowBefore:function(){},onShowNow:function(){},onShowAfter:function(){},onClosedBefore:function(){},onClosedAfter:function(){},onLeft:function(){},onRight:function(){}},a);t(".cartonbox-body").length||t(i.wrap).wrapInner('<div class="cartonbox-body"></div>'),t(".cartonbox-back").length||t('<div class="cartonbox-back"></div>').insertAfter(".cartonbox-body"),t(".cartonbox-preloader").length||t('<div class="cartonbox-preloader"></div>').insertAfter(".cartonbox-back"),t(".cartonbox-wrap").length||t('<div class="cartonbox-wrap"><div class="cartonbox-flex"><div class="cartonbox-item"><div class="cartonbox-container"><div class="cartonbox-content"></div></div></div><div class="cartonbox-nav"></div></div></div><div class="cartonbox-close"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 25"><polygon points="24.4,1.4 23.6,0.6 12.5,11.8 1.4,0.6 0.6,1.4 11.8,12.5 0.6,23.6 1.4,24.4 12.5,13.2 23.6,24.4 24.4,23.6 13.2,12.5"></polygon></svg></div><div class="cartonbox-prev"></div><div class="cartonbox-next"></div>').insertAfter(".cartonbox-preloader"),t(".cartonbox").each(function(){t(this).attr("data-cb-group")&&!t(this).attr("data-cb-group-index")&&t(".cartonbox[data-cb-group="+t(this).attr("data-cb-group")+"]").each(function(a){t(this).attr("data-cb-group-index",a)})});var d=window.location.hash;""!=d&&"#"!=d&&(d=d.replace("#",""),t(".cartonbox[data-cb-hash="+d+"]").length&&o(t(".cartonbox[data-cb-hash="+d+"]"))),t("body, .cartonbox-back, .cartonbox-preloader, .cartonbox-wrap, .cartonbox-flex, .cartonbox-item, .cartonbox-close, .cartonbox-close svg, .cartonbox-close polygon, .cartonbox-nav").unbind(".onClick"),t(window).unbind(".onClick"),t("body").on("click.onClick",".cartonbox-body .cartonbox, .cartonbox-content .cartonbox",function(){return o(t(this)),!1}),t("body").on("click.onClick",".cartonbox-prev a, .cartonbox-next a, .cartonbox-nav li:not(.active) a",function(){return t(this).parent().hasClass("cartonbox-prev")&&i.onLeft(t(this)),t(this).parent().hasClass("cartonbox-next")&&i.onRight(t(this)),n(t(this)),!1}),t(".cartonbox-wrap").on("click.onClick",".cartonbox-nav .active a",function(){return!1}),t(window).on("keydown.onClick",function(a){t(".cartonbox-body").data("cb-top")&&(37==a.which?t(".cartonbox-prev a").length&&(i.onLeft(t(".cartonbox-prev a")),n(t(".cartonbox-prev a"))):39==a.which&&t(".cartonbox-next a").length&&(i.onRight(t(".cartonbox-next a")),n(t(".cartonbox-next a"))))}),t(".cartonbox-back, .cartonbox-preloader, .cartonbox-wrap, .cartonbox-flex, .cartonbox-item, .cartonbox-close, .cartonbox-close svg, .cartonbox-close polygon, .cartonbox-nav").on("click.onClick",function(t){t.target==this&&b()}),t(window).on("keydown.onClick",function(a){t(".cartonbox-body").data("cb-top")&&27==a.which&&b()})},refresh:function(){t(".cartonbox").removeAttr("data-cb-group-index"),t(".cartonbox").each(function(){t(this).attr("data-cb-group")&&!t(this).attr("data-cb-group-index")&&t(".cartonbox[data-cb-group="+t(this).attr("data-cb-group")+"]").each(function(a){t(this).attr("data-cb-group-index",a)})})},destroy:function(){t(".cartonbox").removeAttr("data-cb-group-index"),t("body").unbind(".onClick"),t(window).unbind(".onClick"),t(".cartonbox-body").children().unwrap(),t(".cartonbox-back, .cartonbox-preloader, .cartonbox-wrap, .cartonbox-close, .cartonbox-prev, .cartonbox-next").remove()}};t.cartonbox=function(o){return a[o]?a[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?void t.error("Method "+o+" not found!"):a.init.apply(this,arguments)}}(jQuery);
